{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Catálogo Mayorista</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <header class="bg-dark text-white py-3">
  <div class="container text-center">
    <img src="{% static 'autopart\img\mecanica.png' %}" alt="Logo" style="max-height: 60px;">
  </div>
</header>

  <main class="container my-5">
    <div class="row" id="productos-container">
      <!-- Aquí se insertarán los productos -->
    </div>
  </main>

  <footer class="bg-light text-center py-3">
    <p class="mb-0">© 2025  - Vista Mayorista</p>
  </footer>

  <style>
    body {
      background-image: url("{% static 'autopart\img\lml.png' %}");
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
    }
  </style>

  <script>
  document.addEventListener("DOMContentLoaded", function () {
    fetch("/api/productos-mayorista/")
      .then(response => response.json())
      .then(productos => {
        const contenedor = document.getElementById("productos-container");

        if (productos.length === 0) {
          contenedor.innerHTML = `<p>No hay productos disponibles.</p>`;
          return;
        }

        productos.forEach(prod => {
          const col = document.createElement("div");
          col.className = "col-md-3 mb-4";

          // Formatear el precio como CLP sin decimales
          const precioFormateado = new Intl.NumberFormat("es-CL", {
            style: "currency",
            currency: "CLP",
            minimumFractionDigits: 0
          }).format(prod.precio_mayorista);

          col.innerHTML = `
            <div class="card h-100 shadow">
              <img src="${prod.imagen_url || '/static/autopart/img/default.jpg'}" class="card-img-top" alt="${prod.nombre}">
              <div class="card-body">
                <h5 class="card-title">${prod.nombre}</h5>
                <p class="mb-1"><strong>Precio:</strong> ${precioFormateado}</p>
                <p class="mb-0"><strong>Stock:</strong> ${prod.stock}</p>
              </div>
            </div>
          `;
          contenedor.appendChild(col);
        });
      })
      .catch(error => {
        document.getElementById("productos-container").innerHTML = `<p>Error al cargar los productos.</p>`;
        console.error(error);
      });
  });
</script>

</body>
</html>
